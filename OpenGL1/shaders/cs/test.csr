#version 460 core
layout(local_size_x = 1, local_size_y = 1) in;
uniform sampler2D sadimage;
layout(binding=0,rgba32f) uniform image2D out_image;
layout(binding=1,rgba32f) uniform image2D inputi;


struct SSBO{
    vec3 col;
};
layout(std430, binding=2) buffer ssbo{
    SSBO data[];
};
uniform vec3 offset;
uniform float f;
void main() {
    ivec2 pos = ivec2(gl_GlobalInvocationID.xy);
    vec3 p0=texture2D(sadimage,(pos.xy)/vec2(1600,900)).xyz;
    vec4 p = imageLoad(inputi, pos.xy);
    barrier();
    vec4 color = vec4(0.0,0.0,0.0,1.0);
    for(int i=0;i<8;++i)
        color.rgb+=data[i].col;
//此处可以做一些操作，颜色值改变之类的，我这边示例只做了个提取绿色通道图像
    color.g = p.g;
    color.rb=p0.rb;
    //color.rgb=p0;
    color.xyz+=offset;
    color/=(f+1);
    imageStore( out_image,
                ivec2(gl_GlobalInvocationID.xy),
                color);
}